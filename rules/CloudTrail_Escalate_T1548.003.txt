# Detection: {detection}

**Description:** Detects denied attempts to attach an IAM policy to a user, indicating possible privilege escalation probing.  
**MITRE Technique:** T1548.003 â€“ Abuse Elevation Control Mechanism  
**Severity:** High

---

## Summary

| Metric                         | Value                         |
|--------------------------------|-------------------------------|
| Distinct external IPs          | **{distinct_external_ips}**   |
| Total denied attempts          | **{total_suspicious_requests}** |
| Top attempted operation        | **{highest_risk_operation}**  |

---

## Events

| Timestamp           | Source IP     | API Call           | Error Code    | User Agent            |
|---------------------|---------------|--------------------|---------------|-----------------------|
{events_table}

---

### Analyst Notes

* Repeated AccessDenied on `AttachUserPolicy` suggests an attacker is probing for IAM privilege escalation.

---

### Recommended Actions

1. Review and tighten IAM policies to remove unnecessary `iam:AttachUserPolicy` permissions.  
2. Implement Service Control Policies (SCPs) in AWS Organizations to block unauthorized IAM changes.  
3. Enable CloudTrail alerts on denied IAM write actions for real-time detection.  
4. Conduct an IAM Access Analyzer review to identify overly permissive roles and policies.

---

*Generated on {generated_date}.*  
